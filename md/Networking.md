
 **[Back](https://orientcue.github.io/ios/ "Table of Content")**

# Networking

<!-- TOC -->
- [HTTP](#http)
- [Cocoa Networking](#cocoa-networking)
   - [NSURLSession](#nsurlsession)
   - [Configuration creation](#configuration-creation)
   - [Ephemeral Session Configuration](#ephemeral-session-configuration)
   - [Session creation](#session-creation)
- [NSURLSession tasks](#nsurlsession-tasks)
   - [DataTask](#datatask)
   - [Upload Task](#upload-task)
   - [Download Task](#download-task)
   - [Common methods](#common-methods)
   - [TIPS:](#tips)
- [NSURLSession delegate](#nsurlsession-delegate)
   - [NSURLSessionDelegate](#nsurlsessiondelegate)
   - [NSURLSessionTaskDelegate](#nsurlsessiontaskdelegate)
   - [NSURLSessionDataDelegate](#nsurlsessiondatadelegate)
   - [NSURLSessionDownloadDelegate](#nsurlsessiondownloaddelegate)
- [NSURLSession Summary](#nsurlsession-summary)
- [Background sessions](#background-sessions)
   - [Things to avoid üìõ](#things-to-avoid-)
   - [Best practices üëå](#best-practices-)
- [Handle App Suspension](#handle-app-suspension)
- [Security](#security)
   - [App Transport Security (ATS)](#app-transport-security-ats)
- [Authentication challenge](#authentication-challenge)
- [Data Formats](#data-formats)
   - [JSON](#json)
      - [NSJSONSerialization](#nsjsonserialization)
   - [XML](#xml)
      - [NSXMLParser](#nsxmlparser)
      - [Parser creation](#parser-creation)
      - [Common NSXMLParserDelegate method](#common-nsxmlparserdelegate-method)
- [Useful materials ü§ì](#useful-materials-)
<!-- /TOC -->

## HTTP
**HTTP (Hypertext Transfer Protocol)** - –ø—Ä–æ—Ç–æ–∫–æ–ª –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏. –û–±—â–µ–Ω–∏–µ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, –µ—Å—Ç—å –¥–≤–∞ —Ç–∏–ø–∞ —Å–æ–æ–±—â–µ–Ω–∏–π - **Request** (–∑–∞–ø—Ä–æ—Å) –∫–æ—Ç–æ—Ä—ã–π –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á—Ç–æ–±—ã –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ **Response** (–æ—Ç–≤–µ—Ç) –∫–æ—Ç–æ—Ä—ã–π –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞. 


<img src="https://github.com/OrientCue/ios/blob/master/_resources/2d964899c474496392e4ceb94b59ccfe.png?raw=true">

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞ –∏ –æ—Ç–≤–µ—Ç–∞ –¥–æ–≤–æ–ª—å–Ω–æ-—Ç–∞–∫–∏ –ø–æ—Ö–æ–∂–∞: 

<img src="https://github.com/OrientCue/ios/blob/master/_resources/09e610820852426796fa244b5ec7218b.png?raw=true">

**Start line** - –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å, –∏–ª–∏ –µ–≥–æ —Å—Ç–∞—Ç—É—Å. –í –Ω–µ–º —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è HTTP –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ (**GET**, **POST** etc.). –í—Å–µ–≥–æ –±—ã–≤–∞–µ—Ç 9 –º–µ—Ç–æ–¥–æ–≤, –Ω–æ –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–∑ –Ω–∏—Ö 4:

- **GET (Read)** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∫–∞–∫–æ–π-—Ç–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ä–µ—Å—É—Ä—Å. –í —Ü–µ–ª–µ–≤–æ–π URL –æ–±—ã—á–Ω–æ –≤–∫–ª—é—á–∞—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∏ –≤–µ—Ä–Ω—É—Ç—å —Ç—Ä–µ–±—É–µ–º—ã–π —Ä–µ—Å—É—Ä—Å. 
- **POST (Create)** - –æ–±—ã—á–Ω–æ –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞, –æ–±—ã—á–Ω–æ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫–æ–π-—Ç–æ –∫–æ–Ω—Ç–µ–Ω—Ç. –ù–æ –∑–∞—á–∞—Å—Ç—É—é –º–µ—Ç–æ–¥ POST –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ü–µ–ª–µ–π. 
- **PUT (Update)** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ä–µ—Å—É—Ä—Å, —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è. 
- **DELETE (Delete)** - —É–¥–∞–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å

–ö—Ä–æ–º–µ HTTP –º–µ—Ç–æ–¥–æ–≤ —Ç—É—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ü–µ–ª–µ–≤–æ–π –ø—É—Ç—å –∏ –≤–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ HTTP. –í –æ—Ç–≤–µ—Ç–µ –µ—â–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–ø—Ä–æ—Å–∞ –∏ –µ–≥–æ —Ç–µ–∫—Å—Ç. 

HTTP Headers - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ª–∏–±–æ –≤–µ—Å—å –∑–∞–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç, –ª–∏–±–æ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ –∏–ª–∏ –æ—Ç–≤–µ—Ç–∞. –£—Å–ª–æ–≤–Ω–æ –≤—Å–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ —Ç—Ä–∏ –≥—Ä—É–ø–ø—ã: **general headers** –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é, **request headers** –∫–æ—Ç–æ—Ä—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—Ç –∑–∞–ø—Ä–æ—Å, **entity headers** –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ —Ç–µ–ª—É –∑–∞–ø—Ä–æ—Å–∞. 

**<–ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞>**

**Body** - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ, –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å –∑–∞–ø—Ä–æ—Å–æ–º. –ù–µ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ —ç—Ç–æ–º, –ø–æ—ç—Ç–æ–º—É —Ç–µ–ª–æ –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å.

## Cocoa Networking

–í iOS –≤—ã–¥–µ–ª—è—é—Ç —Ç—Ä–∏ –±–æ–ª—å—à–∏—Ö —Å–ª–æ—è API –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Å–µ—Ç—å—é. 
- **BSD Networking** - –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —Å–ª–æ–π, —Å–æ–∫–µ—Ç—ã –ë–µ—Ä–∫–ª–∏. 
- **CoreFoundation** - –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —Å–ª–æ–π Apple. 
- **Foundation** - –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API Apple.



<img src="https://github.com/OrientCue/ios/blob/master/_resources/cfcb84f1f372468aa9d1fb87e8cbc419.png?raw=true">

## NSURLSession
–ö–ª–∞—Å—Å **NSURLSession** –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–∏–º –∫–ª–∞—Å—Å—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç API –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É URL. 

Concepts
Session and configuration
Session tasks
Session delegate
Credentials (credential storage) 
Cookies (cookie storage) 
Cache
configuration
–û–±—ä–µ–∫—Ç **NSURLSessionConfiguration** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –Ω–∞–±–æ—Ä —Å–≤–æ–π—Å—Ç–≤, –≤–ª–∏—è—é—â–∏—Ö –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ **NSURLSession**. 
–ö–æ–≥–¥–∞ –≤—ã —Å–∫–∞—á–∏–≤–∞–µ—Ç–µ –∏–ª–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Å—Å–∏–∏ ‚Äî —ç—Ç–æ –ø–µ—Ä–≤—ã–π —à–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –¥–æ–ª–∂–Ω—ã —Å–¥–µ–ª–∞—Ç—å. –í–∞–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç –∏ —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –≤—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç–µ –æ–±—ä–µ–∫—Ç NSURLSession. –û–±—ä–µ–∫—Ç NSURLSession —Å–æ–∑–¥–∞–µ—Ç –∫–æ–ø–∏—é –æ–±—ä–µ–∫—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–≤–æ–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –∫–æ–≥–¥–∞ —Å–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞, –æ–Ω–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –¥–µ–ª–∞–µ—Ç–µ –≤ –æ–±—ä–µ–∫—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –ï—Å–ª–∏ –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏–ª–æ—Å—å –∏–∑–º–µ–Ω–∏—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –∏–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏. 

## Configuration creation

```objc
NSURLSessionConfiguration *configuration = [NSURLSessionConfiguration defaultSessionConfiguration];
```

–í–µ—Ä–Ω–µ—Ç –≤–∞–º —ç–∫–∑–µ–º–ø–ª—è—Ä —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –î–∞–ª–µ–µ –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω—è—Ç—å –µ–≥–æ, –ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –µ—Å—Ç—å.


## Ephemeral Session Configuration

 ```objc
NSURLSessionConfiguration *configuration = [NSURLSessionConfiguration ephemeralSessionConfiguration];
```

–î–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–µ—Å—Å–∏—é —Ç–∞–∫ —á—Ç–æ–±—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∫—ç—à, –∫—É–∫–∏, –∫—Ä–∏–¥—ã. –¢–∞–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∂–∏–º—É –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ. 

## Background Session Configuration

```objc
NSURLSessionConfiguration *configuration = [NSURLSessionConfiguration backgroundSessionConfigurationWithIdentifier:@"com.rsschool.background"];
```

–ë—ç–∫–≥—Ä–∞—É–Ω–¥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è. –°–æ–∑–¥–∞–µ—Ç—Å—è —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –º–æ–∂–Ω–æ –ø–æ—Ç–æ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é. –¢–∞–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Å—Å–∏–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É –¥–∞–∂–µ –≤ —Ä–µ–∂–∏–º–µ background, suspended –∏–ª–∏ –¥–∞–∂–µ –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –µ–≥–æ –∞–≤–∞—Ä–∏–π–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∞. 

## Properties that affect transfers
–ü—Ä–∏–º–µ—Ä—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–≤–æ–π—Å—Ç–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ –æ–±—ä–µ–∫—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
- **TLS (Transport Layer Security)** - –ø—Ä–æ—Ç–æ–∫–æ–ª —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –≤ —Å–µ—Ç–∏ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º. –î–æ TLS –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –ø—Ä–æ—Ç–æ–∫–æ–ª SSL. 
- **Cellular usage** - –∏–º–µ–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–π —Å–µ—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –µ—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –º–æ–±–∏–ª—å–Ω—É—é —Å–µ—Ç—å. 
- **Network service type** - –¥–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º —É–∫–∞–∑–∞—Ç—å —Å–∏—Å—Ç–µ–º–µ –¥–ª—è —á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–π —Ç—Ä–∞—Ñ–∏–∫ –≤ —Ä–∞–º–∫–∞—Ö —Å–µ—Å—Å–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤–∏–¥–µ–æ, —Å—Ç—Ä–∏–º–∏–Ω–≥–∞, —Ä–∞–±–æ—Ç—ã –≤ –±—ç–∫–≥—Ä–∞—É–Ω–¥–µ –∏ —Ç.–¥. –î–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–º–æ–∂–µ—Ç —Å–∏—Å—Ç–µ–º–µ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫–∏. 
- **Cookie polices** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–ª–∏—Ç–∏–∫ –¥–ª—è –∫—É–∫–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫—É–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ shared cookie storage, –µ—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Ö –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ, –≤—ã –º–æ–∂–µ—Ç–µ —ç—Ç–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å. 
- **Cache polices** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–ª–∏—Ç–∏–∫ –¥–ª—è –∫—ç—à–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ shared url cache. –ù–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ, —ç—Ç–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å. 

## Additional headers
–í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å —Å–≤–æ–∏ HTTP headers –¥–ª—è —Å–µ—Å—Å–∏–∏ –ø–æ—Å—ã–ª–∞–µ–º–æ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. 

```objc
NSURLSessionConfiguration *configuration = [NSURLSessionConfiguration
                                                      defaultSessionConfiguration];
NSString *userAgentString = @"AppName/com.rsschool.app (iPhone 11 Pro; iOS 13.5.1)";
configuration.HTTPAdditionalHeaders = @{@"Accept" : @"application/json", @"Accept-Language" : @"en",@"User-Agent" : userAgentString};
```

–í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ—Ä–º–∞—Ç JSON, —è–∑—ã–∫ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –∏ User-Agent. –≠—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è —Å–µ—Ä–≤–µ—Ä—É —á—Ç–æ –±—ã –æ–Ω –ø–æ–Ω–∏–º–∞–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä —Å –∫–∞–∫–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –µ–º—É –ø–æ—Å—ã–ª–∞–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å. 

## Session creation
–ï—Å—Ç—å —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞ —Å–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é. –ü–µ—Ä–≤—ã–π, –≤—ã–∑–≤–∞—Ç—å sharedSession: 

```objc
NSURLSession *session = [NSURLSession sharedSession];
```

–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∏–Ω–≥–ª—Ç–æ–Ω –¥–ª—è —Å–µ—Å—Å–∏–∏, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –Ω–µ –Ω—É–∂–µ–Ω –æ–±—ä–µ–∫—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é –¥–ª—è –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π. 

–í—Ç–æ—Ä–æ–π —Å–ø–æ—Å–æ–±, –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥ sessionWithConfiguration:

```objc
NSURLSessionConfiguration *configuration = [NSURLSessionConfiguration
                                             defaultSessionConfiguration];
NSURLSession *session = [NSURLSession sessionWithConfiguration:configuration];                                          
```

–ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º —Å–µ—Å—Å–∏–∏, –Ω–æ —É –∫–æ—Ç–æ—Ä–æ–π –≤—Å–µ –µ—â–µ –Ω–µ—Ç –¥–µ–ª–µ–≥–∞—Ç–∞. –ï—Å–ª–∏ –≤—ã —Å–æ–∑–¥–∞–µ—Ç–µ —Å–µ—Å—Å–∏–∏—é —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ç–æ –æ–Ω–∞ –Ω–∏—á–µ–º –Ω–µ –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—Å—è –æ—Ç sharedSession. 

–¢—Ä–µ—Ç–∏–π —Å–ø–æ—Å–æ–±

```objc
NSOperationQueue *queue = [NSOperationQueue new];
NSURLSessionConfiguration *configuration = [NSURLSessionConfiguration
                                           defaultSessionConfiguration];
NSURLSession *session = [NSURLSession sessionWithConfiguration:configuration
                                                     delegate:self  delegateQueue:queue];
```

## NSURLSession tasks
–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å, –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç - –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É(task) –¥–ª—è –≤–∞—à–µ–π —Å–µ—Å—Å–∏–∏. –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –∑–∞–¥–∞—á –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

<img src="https://github.com/OrientCue/ios/blob/master/_resources/60e9b879641048879278ce58c7e985fd.png?raw=true">

–ë–∞–∑–æ–≤—ã–º –∫–ª–∞—Å—Å–æ–º —è–≤–ª—è–µ—Ç—Å—è **NSURLSessionTask**, –¥–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å –ø–æ —Å–≤–æ–µ–π —Å—É—Ç–∏ —è–≤–ª—è–µ—Ç—Å—è –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –Ω–∞–ø—Ä—è–º—É—é –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ. –£ –Ω–µ–≥–æ –µ—Å—Ç—å —Ç–∞–∫–∏–µ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∏ –∫–∞–∫   **NSURLSessionDataTask** –∏ **NSURLSessionDownloadTask**. –£ NSURLSessionDataTask –µ—Å—Ç—å —Å–≤–æ–π –Ω–∞—Å–ª–µ–¥–Ω–∏–∫ **NSURLSessionUplaodTask**. –í –∏—Ç–æ–≥–µ –º—ã –∏–º–µ–µ–º —Ç—Ä–∏ –Ω–∞–∏–±–æ–ª–µ–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–ª–∞—Å—Å–∞ –¥–ª—è –∑–∞–¥–∞—á, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç—Ä–µ–º —Ç–∏–ø–∞–º –∑–∞–¥–∞—á: Data Task,  Download Task –∏ UplaodTask. –ï—Å—Ç—å –µ—â–µ WebSocket task.

## DataTask
–ü–æ—Å—ã–ª–∞–µ—Ç –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç NSData –æ–±—ä–µ–∫—Ç. –≠—Ç–∏ –∑–∞–¥–∞—á–∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. –° –ø–æ–º–æ—â—å—é —ç—Ç–∏—Ö –∑–∞–¥–∞—á –º—ã —Å–∫–∞—á–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å. –§–∞–π–ª—ã —Ç–æ–∂–µ –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, –æ–¥–Ω–∞–∫–æ —Å –Ω–∞—á–∞–ª–∞ –æ–Ω–∏ –±—É–¥—É—Ç —Å–∫–∞—á–∞–Ω—ã –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å, –Ω–æ –ø–æ–∑–∂–µ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Ö –Ω–∞ –¥–∏—Å–∫. 
–ü–µ—Ä–≤—ã–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞—Ç—å data task, —ç—Ç–æ –≤—ã–∑–≤–∞—Ç—å dataTaskWithURL: –∏ –ø–µ—Ä–µ–¥–∞—Ç—å —Ç—É–¥–∞ —Ü–µ–ª–µ–≤—É—é URL. 

```objc
NSURL *url = [NSURL URLWithString:@"https://rs.school"];
NSURLSession *session = [NSURLSession sharedSession];
NSURLSessionDataTask *dataTask = [session dataTaskWithURL:url];
```

–í—Ç–æ—Ä–æ–π —Å–ø–æ—Å–æ–±, —ç—Ç–æ –≤—ã–∑–≤–∞—Ç—å **dataTaskWithRequest**: —Å –ø–µ—Ä–µ–¥–∞—á–µ–π –æ–±—ä–µ–∫—Ç–∞ —Ç–∏–ø–∞ NSURLRequest. –û–±—ã—á–Ω–æ —Ä–µ–∫–≤–µ—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–∞–∫—É—é-—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

```objc
NSURL *url = [NSURL URLWithString:@"https://rs.school"];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
NSURLSession *session = [NSURLSession sharedSession];
NSURLSessionDataTask *dataTask = [session dataTaskWithRequest:request];
```

–¢–∞–∫–∂–µ –µ—Å—Ç—å –≤–∞–∂–Ω–æ –æ—Ç–ª–∏—á–∏–µ –º–µ–∂–¥—É –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å dataTaskWithURL –≤ –æ—Ç–ª–∏—á–∏–∏ –æ—Ç dataTaskWithRequest. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, HTTP –º–µ—Ç–æ–¥ —É –∑–∞–ø—Ä–æ—Å–∞ - GET. –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–µ–Ω –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥, —Ç–æ –≤—ã –Ω–∏–∫–∞–∫ –Ω–µ –º–æ–∂–µ—Ç–µ –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ NSURLRequest. –ü–æ—ç—Ç–æ–º—É –≤–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π —ç–∫–∑–µ–º–ø–ª—è—Ä NSURLRequest –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–≥–æ. 

## Upload Task

–≠—Ç–∏ –∑–∞–¥–∞—á–∏ –ø–æ—Ö–æ–∂–∏ –Ω–∞ Data Task –Ω–æ —á–∞—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —á–∞—â–µ –≤ —Ñ–æ—Ä–º–µ —Ñ–∞–π–ª–æ–≤ –∏ –≤ –æ—Ç–ª–∏—á–∏–∏ –æ—Ç Data Task –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –±—ç–∫–≥—Ä–∞—É–Ω–¥ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø—Ä–∏–º–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ.
–°–æ–∑–¥–∞—Ç—å —Ç–∞–∫—É—é –∑–∞–¥–∞—á—É –º–æ–∂–Ω–æ —Ç—Ä–µ–º—è —Å–ø–æ—Å–æ–±–∞–º–∏. –ü–µ—Ä–≤—ã–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ **uploadTaskWithRequest:fromData:** –∫—É–¥–∞ –ø–µ—Ä–µ–¥–∞–µ–º –∏–Ω—Å—Ç–∞–Ω—Å NSURLRequest –∏ –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ NSData. 

```objc
NSURL *url = [NSURL URLWithString:@"https://rs.school"];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
NSData *data = [NSData new];
NSURLSession *session = [NSURLSession sharedSession];
NSURLSessionUploadTask *uploadTask = [session uploadTaskWithRequest:request
                                                           fromData:data];
```

–í—Ç–æ—Ä–æ–π —Å–ø–æ—Å–æ–± —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ **uploadTaskWithRequest:fromFile:** –∫—É–¥–∞ –ø–µ—Ä–µ–¥–∞–µ–º –∏–Ω—Å—Ç–∞–Ω—Å —Ä–µ–∫–≤–µ—Å—Ç–∞ –∏ –ª–æ–∫–∞–ª—å–Ω—ã–π URL –∫ —Ñ–∞–π–ª—É –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å.

```objc
NSURL *url = [NSURL URLWithString:@"https://rs.school"];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
NSURL *fileUrl = [NSURL fileURLWithPath:[NSTemporaryDirectory() stringByAppendingPathComponent:@"quiz.pdf"]];
NSURLSession *session = [NSURLSession sharedSession];
NSURLSessionUploadTask *uploadTask = [session uploadTaskWithRequest:request fromFile:fileUrl];
```

—Ç—Ä–µ—Ç–∏–π —Å–ø–æ—Å–æ–± —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ uploadTaskWithStreamedRequest: –∫—É–¥–∞ –ø–µ—Ä–µ–¥–∞–µ–º –∏–Ω—Å—Ç–∞–Ω—Å NSURLRequest

```objc
NSURL *url = [NSURL URLWithString:@"https://rs.school"];
NSURLRequest *request = [NSURLRequest requestWithURL:url]; 
NSURLSession *session = [NSURLSession sharedSession];
NSURLSessionUploadTask *uploadTask = [session uploadTaskWithStreamedRequest:request];
```


## Download Task
–≠—Ç–∏ –∑–∞–¥–∞—á–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–∫–∞—á–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏—Ö –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ –¥–∏—Å–∫ –∏ —Ç–∞–∫–∂–µ –æ–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –±—ç–∫–≥—Ä–∞—É–Ω–¥ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ. 
–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–∫–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞: 
–ü–µ—Ä–≤—ã–π, —Å –ø–æ–º–æ—â—å—é –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–∞ **downloadTaskWithURL**: –∫—É–¥–∞ –ø–µ—Ä–µ–¥–∞–µ–º URL –∏—Å—Ç–æ—á–Ω–∏–∫–∞. 

```objc
NSURL *url = [NSURL URLWithString:@"https://rs.school"];
NSURLSession *session = [NSURLSession sharedSession];
NSURLSessionDownloadTask *downloadTask = [session downloadTaskWithURL:url];
```

–í—Ç–æ—Ä–æ–π, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∏–Ω—Å—Ç–∞–Ω—Å–∞ NSURLRequest. 

```objc
NSURL *url = [NSURL URLWithString:@"https://rs.school"];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
NSURLSession *session = [NSURLSession sharedSession];
NSURLSessionDownloadTask *downloadTask = [session downloadTaskWithRequest:request];
```

–¢—Ä–µ—Ç–∏–π, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –µ—Å–ª–∏ —Ä–∞–Ω–µ–µ –æ–Ω–æ –±—ã–ª–æ –æ—Ç–º–µ–Ω–µ–Ω–æ, –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ **downloadTaskWithResumeData**: –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Ç–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–∞ NSData –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏. 

```objc
NSData *data = [NSData new];
NSURLSession *session = [NSURLSession sharedSession];
NSURLSessionDownloadTask *downloadTask = [session downloadTaskWithResumeData:data];
```

## Common methods
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –≤—Å–µ –∑–∞–¥–∞—á–∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥ **resume**: —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∏–ª–∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏. 
`[downloadTask resume];`
–ß—Ç–æ–±—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞—á—É, –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ suspend:
`[downloadTask suspend];`
–ß—Ç–æ–±—ã –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É, –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ cancel:
`[downloadTask cancel];`

## TIPS:
–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—à–µ–ª –Ω–∞ —ç–∫—Ä–∞–Ω –∏ –Ω–∞—á–∞–ª–∞—Å—å –∑–∞–≥—Ä—É–∑–∫–∞, –∞ –ø–æ—Ç–æ–º –æ–Ω –∑–∞–∫—Ä—ã–ª –µ–≥–æ, —Ç–æ –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, —Ö–æ—Ç—è –¥–∞–Ω–Ω—ã–µ —É–∂–µ –Ω–µ –Ω—É–∂–Ω—ã. –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å –æ—Ç–º–µ–Ω–æ–π –∑–∞–≥—Ä—É–∑–æ–∫. 

–°–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –≤ —Å–≤–æ–π—Å—Ç–≤–µ state. –ó–∞–¥–∞—á–∞ –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ **Running**, **Suspended**, **Canceling** –∏ **Completed**

`@property (readonly) NSURLSessionTaskState state;`

–î–ª—è –∑–∞–¥–∞—á–∏ –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ—Ç–æ—Ä—ã–π –≤—ã—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —á–∏—Å–ª–µ –æ—Ç 0 –¥–æ 1. 

`@property float priority`

–°–≤–æ–π—Å—Ç–≤–æ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –æ–±—ä–µ–∫—Ç —Ç–µ–∫—É—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. 

`@property (nullable, readonly, copy) NSURLRequest  *currentRequest;`

–ó–∞–¥–∞—á–∞ –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å –æ–±—ä–µ–∫—Ç —Ä–µ–∫–≤–µ—Å—Ç–∞ –≤ —Ç–µ—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏, –∏ –¥–∞–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—ä–µ–∫—Ç —Ä–µ–∫–≤–µ—Å—Ç–∞ —Å –∫–æ—Ç–æ—Ä—ã–º —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å –∑–∞–¥–∞—á–∞. 

`@property (nullable, readonly, copy) NSURLRequest  *originalRequest;`  

–≠—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Ç–≤–µ—Ç –æ–±—ä–µ–∫—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏.

`@property (nullable, readonly, copy) NSURLResponse *response;`

## NSURLSession delegate
–ï—Å—Ç—å 4 –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ NSURLSession delegate:

- `NSURLSessionDelegate` 
- `NSURLSessionTaskDelegate` 
- `NSURLSessionDataDelegate` 
- `NSURLSessionDownloadDelegate`

**!!!–í–ê–ñ–ù–û!!! –°–µ—Å—Å–∏—è –¥–µ—Ä–∂–∏—Ç —Å–∏–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –æ–±—ä–µ–∫—Ç –¥–µ–ª–µ–≥–∞—Ç–∞ –ø–æ–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≤–µ—Ä—à–∏—Ç —Ä–∞–±–æ—Ç—É –∏–ª–∏ –≤—ã —è–≤–Ω–æ –Ω–µ –≤—ã–∑–æ–≤–∏—Ç–µ invalidateAndCancel: –∏–ª–∏ finishTasksAndInvalidate:. –ï—Å–ª–∏ —ç—Ç–æ–≥–æ –Ω–µ —Å–¥–µ–ª–∞—Ç—å —è–≤–Ω–æ, –±—É–¥–µ—Ç –Ω–∞–±–ª—é–¥–∞—Ç—å—Å—è —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏.**



## NSURLSessionDelegate

–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–µ–Ω –∑–∞ –º–µ—Ç–æ–¥—ã, –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∫ —Å–µ—Å—Å–∏–∏. –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∑–∞–¥–∞—á–∏ –±–µ–∑ completion, —Ç–æ –æ—à–∏–±–∫–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ NSURLSessionDelegate. –¢–∞–∫–∂–µ –¥–∞–Ω–Ω—ã–π –¥–µ–ª–µ–≥–∞—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–±–ª—é–¥–∞—Ç—å –∑–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –¥–ª—è –≤—Å–µ–π —Å–µ—Å—Å–∏–∏. 

## NSURLSessionTaskDelegate

–†–∞—Å—à–∏—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ NSURLSessionDelegate, —Ç–∞–∫–∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–±–ª—é–¥–∞—Ç—å –∑–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ç–∞–∫–∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –æ—à–∏–±–∫–∏. 

## NSURLSessionDataDelegate

–†–∞—Å—à–∏—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ NSURLSessionTaskDelegate. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —É–∂–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∑–∞–≥—Ä—É–∑–∫–∏. 
–ö–æ–≥–¥–∞ –º—ã —Å–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á—É, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ suspended. –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–∞ resume: —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ running. –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –º—ã –ø–æ–ª—É—á–∏–ª–∏ —Ö–µ–¥–µ—Ä—ã –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥: **`didReceiveResponse`**:. –ö–æ–≥–¥–∞ –ø–æ–ª—É—á–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥: **`didReceiveData`**:, –¥–∞–ª—å—à–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **`willCacheResponse`**:. –í –∫–æ–Ω—Ü–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–µ–ª–µ–≥–∞—Ç–Ω—ã–π –º–µ—Ç–æ–¥: **`didCompleteWithError`**:, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å —ç—Ç–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ Finished 

## NSURLSessionDownloadDelegate
–†–∞—Å—à–∏—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ NSURLSessionTaskDelegate. –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç URL –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Ñ–∞–π–ª—É, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≥—Ä—É–∑–∫–∏. 
–ö–æ–≥–¥–∞ –º—ã —Å–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á—É, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ suspended. –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–∞ resume: —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ running. –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –º—ã –ø–æ–ª—É—á–∏–ª–∏ —Ö–µ–¥–µ—Ä—ã –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥: **`didWriteData`**:. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥: **didFinishDownloadingToUrl**:. –í –∫–æ–Ω—Ü–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–µ–ª–µ–≥–∞—Ç–Ω—ã–π –º–µ—Ç–æ–¥: didCompleteWithError:, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å —ç—Ç–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ Finished.

## NSURLSession Summary
–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã —Å NSURLSession –∑–∞–¥–∞—á–∞–º–∏ —ç—Ç–æ –ø–æ –±–æ–ª—å—à–æ–º—É —Å—á–µ—Ç—É –ø—Ä–æ—Ü–µ—Å—Å –∏–∑ —Ç—Ä–µ—Ö —à–∞–≥–æ–≤. 
1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
3. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏(—Ç–∞—Å–∫–∏)

**TIPS**:
–ù–µ –Ω—É–∂–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é. –ï—Å–ª–∏ –≤—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å –æ–¥–Ω–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º –∏–ª–∏ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ö–æ–¥–∏—Ç –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–Ω—É —Å–µ—Å—Å–∏—é.  

<img src="https://github.com/OrientCue/ios/blob/master/_resources/7d63771c3e2d4844bc8e6326bdee42de.png?raw=true">

## Background sessions

–≠—Ç–∏ —Å–µ—Å—Å–∏–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–∂–µ –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ –∏ –∞–≤–∞—Ä–∏–π–Ω–æ–π –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å. –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –±—ç–∫–≥—Ä–∞—É–Ω–¥ —Å–µ—Å—Å–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö –∏ —Ç—è–∂–µ–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –∞ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –Ω–∞—á–∞—Ç—ã, –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—ã–ª–æ –∑–∞–ø—É—â–µ–Ω–æ. –°–∏—Å—Ç–µ–º–∞ –∏–º–µ–µ—Ç —Ä—è–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –≤—ã –º–æ–∂–µ—Ç–µ —Å—Ç–æ–ª–∫–Ω—É—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞—á –Ω–∞ –±—ç–∫–≥—Ä–∞—É–Ω–¥ —Å–µ—Å—Å–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –±–æ–ª—å—à–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–ª–∏ –¥–µ–ª–∞—Ç—å –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —É–±–∏–≤–∞—Ç—å —ç—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –∑–∞–¥–∞—á, —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–∑–±—É–¥–∏—Ç—å –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∫–∏—Ö-—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.

## Things to avoid üìõ

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–ª–∏ –±—É–¥–∏—Ç –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é –±—ç–∫–≥—Ä–∞—É–Ω–¥ –∑–∞–≥—Ä—É–∑–∫–∏, –æ–Ω–∞ –º–æ–∂–µ—Ç –ø–æ–Ω–∏–∂–∞—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤–∞—à–∏—Ö –∑–∞–≥—Ä—É–∑–æ–∫ —á—Ç–æ–±—ã —Ä–µ–∂–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. 
–ù–µ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–µ–π –∏–¥–µ–µ–π –±—É–¥–µ—Ç –∫–∞—á–∞—Ç—å –º–Ω–æ–≥–æ –º–µ–ª–∫–∏—Ö —Ñ–∞–π–ª–æ–≤, –ª—É—á—à–µ —Å–∫–∞—á–∏–≤–∞—Ç—å –æ–¥–∏–Ω –±–æ–ª—å—à–æ–π –∞—Ä—Ö–∏–≤.
–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç delay –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ –Ω–æ–≤—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫ –≤ –±—ç–∫–≥—Ä–∞—É–Ω–¥–µ, —á—Ç–æ–±—ã –≤—ã –Ω–µ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è–ª–∏ –±—ç–∫–≥—Ä–∞—É–Ω–¥ –∑–∞–≥—Ä—É–∑–∫–∞–º–∏. –í–∞—à–∞ –∑–∞–¥–∞—á–∞ –Ω–µ –Ω–∞—á–Ω–µ—Ç—Å—è –ø–æ–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∞. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, delay —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–ª–∏ –±—É–¥–∏—Ç –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. 

## Best practices üëå

–°–∫–∞—á–∏–≤–∞–π—Ç–µ –æ–¥–∏–Ω –±–æ–ª—å—à–æ–π, –∞ –Ω–µ –º–Ω–æ–≥–æ –º–µ–ª–∫–∏—Ö —Ñ–∞–π–ª–æ–≤. 
–ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –º–µ—Ö–∞–Ω–∏–∑–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤–∞—à–µ–π —Å–µ—Å—Å–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–æ–∫.

## Handle App Suspension
–†–∞–∑–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–ª–∏—è—é—Ç –Ω–∞ —Ç–æ, –∫–∞–∫ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –±—ç–∫–≥—Ä–∞—É–Ω–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π. –ï—Å–ª–∏ –Ω–∞ foreground –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—Å–µ –∫–∞–∫ –æ–±—ã—á–Ω–æ, —Ç–æ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ suspended –∏–ª–∏ not-running –≤—Å–µ –∏–Ω–∞—á–µ. –ï—Å–ª–∏ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –≤ –±—ç–∫–≥—Ä–∞—É–Ω–¥–µ, —Ç–æ —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –µ–≥–æ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ suspended –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç, –∞ –±—ç–∫–≥—Ä–∞—É–Ω–¥ –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—Å—è –≤ –¥—Ä—É–≥–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ. –ö–æ–≥–¥–∞ –±—ç–∫–≥—Ä–∞—É–Ω–¥ –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è, —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–∏—Ç –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏ –ø–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É –≤—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥:

```objc
- (void)application:(UIApplication *)application 
handleEventsForBackgroundURLSession:(NSString *)identifier 
completionHandler:(void (^)(void))completionHandler
```

–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ç–æ—Ä–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–æ–ª—É—á–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Å—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —É–∫–∞–∑—ã–≤–∞–µ—Ç–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏. –í–∞–º –Ω—É–∂–Ω–æ —Å–Ω–æ–≤–∞ —Å–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é —Å —ç—Ç–∏–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–µ–ª–µ–≥–∞—Ç–∞. –¢–∞–∫–∂–µ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ç—Ä–µ—Ç—å–µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–æ–ª—É—á–∞–µ—Ç completionHandler, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ —Å—Ä–∞–∑—É-–∂–µ –≤ –ø–æ–¥—Ö–æ–¥—è—â–µ–º –¥–ª—è —ç—Ç–æ–≥–æ –º–µ—Å—Ç–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ –∫–ª–∞—Å—Å–µ, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –¥–µ–ª–µ–≥–∞—Ç–æ–º –¥–ª—è –≤–∞—à–µ–π —Å–µ—Å—Å–∏–∏. 
–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–æ–±—ã—Ç–∏—è –±—ã–ª–∏ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã, —Å–∏—Å—Ç–µ–º–∞ –≤—ã–∑—ã–≤–∞–µ—Ç NSURLSessionDelegate –º–µ—Ç–æ–¥: 

```objc
- (void)URLSessionDidFinishEventsForBackgroundURLSession:(NSURLSession *)session
```

–≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–∑–≤–∞—Ç—å —Ä–∞–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π completionHandler. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –Ω–µ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏, —Ç–∞–∫ —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é –æ—á–µ—Ä–µ–¥—å. –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ completionHandler –∑–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É –∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥:

```objc
- (void)URLSession:(NSURLSession *)session
      downloadTask:(NSURLSessionDownloadTask *)downloadTask
      didFinishDownloadingToURL:(NSURL *)location
```

–ü–æ—Å–ª–µ –Ω–µ–≥–æ –∑–∞–≥—Ä—É–∑–∫–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π. 

## Security
### App Transport Security (ATS)

–ù–∞—á–∏–Ω–∞—è —Å iOS9 –∑–∞–ø—Ä–µ—â–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –≤ iOS –ø–æ—è–≤–∏–ª–∞—Å—å —Ç–∞–∫–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è –∫–∞–∫ ATS, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–∑–≤–∞–Ω–∞ —É–ª—É—á—à–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. ATS —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤—Å–µ HTTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Å–æ–≤–µ—Ä—à–∞–µ—Ç–µ, –∏—Å–ø–æ–ª—å–∑—É—è URLSession –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ HTTPS –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –í—ã –º–æ–∂–µ—Ç–µ –æ—Å–ª–∞–±–∏—Ç—å –∏–ª–∏ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã –¥–æ–±–∞–≤–∏–≤ —Å–ª–æ–≤–∞—Ä—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫ –∫–ª—é—á—É
**`NSAppTransportSecurity`** –≤ info.plist —Ñ–∞–π–ª–µ. 
–ü–æ –∫–ª—é—á—É **NSExceptionDomains** –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤. –ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–≤–æ–π—Å—Ç–≤ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ —Å–≤–æ–∏ –∫–ª—é—á–∞–º. 



```objc
NSExceptionDomains : Dictionary {
      <domain-name-string> : Dictionary {
       NSIncludesSubdomains : Boolean
        NSExceptionAllowsInsecureHTTPLoads : Boolean
        NSExceptionMinimumTLSVersion : String
        NSExceptionRequiresForwardSecrecy : Boolean
        NSRequiresCertificateTransparency : Boolean

} }
```

**`NSExceptionAllowsInsecureHTTPLoads`**

–°–∞–º—ã–π —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π. –ù–∞–ø—Ä–∏–º–µ—Ä, —É –Ω–∞—Å –µ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç HTTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç–æ—Ç —Å–µ—Ä–≤–µ—Ä –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∏–≤ –¥–ª—è –Ω–µ–≥–æ –ø–æ —ç—Ç–æ–º—É –∫–ª—é—á—É –∑–Ω–∞—á–µ–Ω–∏–µ YES. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Å–∏—Å—Ç–µ–º–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Å —ç—Ç–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É HTTP. 

**`NSExceptionMinimumTLSVersion`**

–ü–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–æ–ø—É—Å—Ç–∏–º—É—é –≤–µ—Ä—Å–∏—é TLS. 

**`NSExceptionRequiresForwardSecrecy`**

–ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ NO, —Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –±—É–¥–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å —É —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ perfect forward secrecy (PFS). 

**`NSRequiresCertificateTransparency`**

–ö–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ Certificate Transparency (CT) ‚Äî —ç—Ç–æ –ø—Ä–æ—Ç–æ–∫–æ–ª, –∫–æ—Ç–æ—Ä—ã–π ATS –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—à–∏–±–æ—á–Ω–æ –∏–ª–∏ –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –≤—ã–¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ X.509.

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –æ—Å–ª–∞–±–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è ATS –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, –≤—ã –≤—Å–µ–≥–¥–∞ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –≤—ã –¥–æ–ª–∂–Ω—ã –∏—Å–∫–∞—Ç—å —Å–ø–æ—Å–æ–±—ã —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø—Ä–µ–∂–¥–µ —á–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è. –°–Ω–∏–∂–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π ATS —É–º–µ–Ω—å—à–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. 

## Authentication challenge

–ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä —É –≤–∞—Å –∏—Å—Ç–µ–∫–ª–æ –≤—Ä–µ–º—è –¥–ª—è —Ç–æ–∫–µ–Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –≤—ã –ø–æ–ª—É—á–∏–ª–∏ —Ä–∞–Ω–µ–µ –∏–ª–∏ –≤–æ–≤—Å–µ —Ö–∏–¥–µ—Ä –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ, –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—Ä–æ—Å –∫–∞–∫–∏–º-—Ç–æ –æ–±—Ä–∞–∑–æ–º –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å. –ö–æ–≥–¥–∞ –º—ã —Å—Ç–∞–ª–∫–∏–≤–∞–µ–º—Å—è —Å authentication challenge —É–≤–µ–¥–æ–º–ª—è–µ—Ç –æ–± —ç—Ç–æ–º —Å–≤–æ–µ–≥–æ –¥–µ–ª–µ–≥–∞—Ç–∞ —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ —ç—Ç–æ –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å. –ü–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∑–∞–¥–∞—á—É —Å completionBlock, **–±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –¥–µ–ª–µ–≥–∞—Ç–∞**, –≤—ã –Ω–µ —Å–º–æ–∂–µ—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å authentication challenge. 

–ö–æ–≥–¥–∞ –º—ã –ø–æ–ª—É—á–∞–µ–º –≤–∞–ª–∏–¥–Ω—ã–π authentication challenge, –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º —Å–µ—Å—Å–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç –¥–µ–ª–µ–≥–∞—Ç–Ω—ã–π –º–µ—Ç–æ–¥ –æ—Ç–Ω–æ—Å—è—â–µ–π—Å—è –∫ –∑–∞–¥–∞—á–µ:

```objc
- (void)URLSession:(NSURLSession *)session task:(NSURLSessionTask *)task
    	didReceiveChallenge:(NSURLAuthenticationChallenge *)challenge
    	completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition,
                   	          NSURLCredential * _Nullable))completionHandler
``` 

–ï—Å–ª–∏ –¥–µ–ª–µ–≥–∞—Ç –∑–∞–¥–∞—á–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –¥–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, —Ç–æ —Å–µ—Å—Å–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç —Å–≤–æ–π –¥–µ–ª–µ–≥–∞—Ç–Ω—ã–π –º–µ—Ç–æ–¥:

```objc
- (void)URLSession:(NSURLSession *)session didReceiveChallenge:(NSURLAuthenticationChallenge *)challenge
 completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition, NSURLCredential * _Nullable))completionHandler
```

–£ –Ω–∞—Å –µ—Å—Ç—å —Ç—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∫–∞–∫ –º—ã –º–æ–∂–µ–º –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å authentication challenge:

- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–≤–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–ø—Ä–æ—Å –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –û—Ç–º–µ–Ω–∏—Ç—å authentication challenge

–ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –∫–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –ø–æ–¥—Ö–æ–¥—è—â–∏–º, —ç–∫–∑–µ–º–ø–ª—è—Ä challenge —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —á–µ–º –æ–Ω –±—ã–ª –≤—ã–∑–≤–∞–Ω, —Å–∫–æ–ª—å–∫–æ –ø–æ–ø—ã—Ç–æ–∫ —É–∂–µ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ –∏.—Ç.–¥. 

## Data Formats
–ö–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–µ—Ä –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π, –±–æ–ª—å—à–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–º–µ–µ—Ç —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö. –ê –∏–º–µ–Ω–Ω–æ, –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö, —Å –∫–æ—Ç–æ—Ä—ã–º —É–º–µ–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ–ª—É—á–∞—Ç–µ–ª—å. –û–¥–Ω–∏–º–∏ –∏–∑ —Å–∞–º—ã—Ö —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —è–≤–ª—è—é—Ç—Å—è 

- **XML**
- **JSON**

## JSON

–í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è, –º–Ω–æ–≥–∏–µ –Ω–æ–≤—ã–µ API –∏—Å–ø–æ–ª—å–∑—É—é—Ç JSON - —ç—Ç–æ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π —Ñ–æ—Ä–º–∞—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π —Å–æ–±–æ–π –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ.  
```
{  //–∫–ª—é—á   –∑–Ω–∞—á–µ–Ω–∏–µ
    "crust": "original",
    "toppings": ["cheese", "pepperoni", "tomatoes"],
    "status": "cooking"
}
```

–ò–Ω–æ–≥–¥–∞ –≤–∞–º –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –∑–∞–ø–∏—Å–∞—Ç—å —Ü–µ–ª—ã–π –æ–±—ä–µ–∫—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–∞–∫–æ–≥–æ-—Ç–æ –∫–ª—é—á–∞, —ç—Ç–æ —Ç–æ–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å. –í –ø—Ä–∏–º–µ—Ç–µ –∞—Ç—Ä–∏–±—É—Ç "customer" –≤ –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–µ—â–µ–Ω –æ–±—ä–µ–∫—Ç. 

```json
{
"crust": "original",
"toppings": ["cheese", "pepperoni", "tomatoes"], "status": ‚Äúcooking‚Äù,
"customer": {
       "name": "Brian",
       "phone": "573-111-1111" 
   }
}
```

## NSJSONSerialization

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ NSJSONSerialization –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON. –ß—Ç–æ–±—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–π JSON –æ–±—ä–µ–∫—Ç, —Å –∫–æ—Ç–æ—Ä—ã–º –≤—ã –º–æ–∂–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Å–≤–æ–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ –∫–ª–∞—Å—Å–∞: 


```objc
+ (id)JSONObjectWithData:(NSData *)data
                 options:(NSJSONReadingOptions)opt
                   error:(NSError **)error;
```

–ì–¥–µ data —ç—Ç–æ –æ–±—ä–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∞—â–∏–π JSON, options —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø—Ü–∏–∏ –¥–ª—è —á—Ç–µ–Ω–∏—è, –∏ error –∫—É–¥–∞ –±—É–¥–µ—Ç –ø–æ–º–µ—â–µ–Ω–∞ –æ—à–∏–±–∫–∞ –≤ —Å–ª—É—á–∞–µ –Ω–µ—É–¥–∞—á–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞. 

## XML
–î–æ–≤–æ–ª—å–Ω–æ —Å—Ç–∞—Ä—ã–π, –Ω–æ –º–æ—â–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Enterprice —Ä–µ—à–µ–Ω–∏—è—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö. –ö–∞–∫ –∏ JSON –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–∑ —Å–µ–±—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–∞—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ. –û—Å–Ω–æ–≤–Ω—ã–º –±–ª–æ–∫–æ–º –≤ XML —è–≤–ª—è–µ—Ç—Å—è Node, –∫–∞–∂–¥—ã–π node –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—Å—è —Å –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏–º —Ç–µ–≥–æ–º –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —Å –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–º. –ò–º—è –Ω–æ–¥—ã –≥–æ–≤–æ—Ä–∏—Ç –æ–± –∞—Ç—Ä–∏–±—É—Ç–µ. –ú–µ–∂–¥—É —Ç–µ–≥–∞–º–∏ –Ω–æ–¥—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è. 

```xml
<order>
    <crust>original</crust>
    <toppings>//Node open tag
       <topping>cheese</topping>
        <topping>pepperoni</topping> //Values
        <topping>garlic</topping>
    </toppings>//Node close tag
   <status>cooking</status>
</order>
```

## NSXMLParser
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ NSXMLParser –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ XML. –î–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å –≤ –æ—Ç–ª–∏—á–∏–∏ –æ—Ç NSJSONSerialization –∫–æ—Ç–æ—Ä—ã–π —Å –ø–æ–º–æ—â—å—é –æ–¥–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å Foundation –æ–±—ä–µ–∫—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—ç—Ç–∞–ø–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑—É—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ–ª–µ–≥–∞—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤. 

## Parser creation
–ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä—Å–µ—Ä, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω–∏—Ç –º–µ—Ç–æ–¥–∞ –∫—É–¥–∞ –ø–µ—Ä–µ–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ XML. 

```objc
- (instancetype)initWithData:(NSData *)data;
```

–°—Ç–∞—Ä—Ç—É–µ–º –ø–∞—Ä—Å–µ—Ä –≤—ã–∑–æ–≤–æ–º –º–µ—Ç–æ–¥–∞: 

`- (BOOL)parse;`

## Common NSXMLParserDelegate method

–ö–æ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ø–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–∞, —É –¥–µ–ª–µ–≥–∞—Ç–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥:

```objc
- (void)parserDidStartDocument:(NSXMLParser *)parser;
```

–ö–æ–≥–¥–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –ø–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–∞, —É –¥–µ–ª–µ–≥–∞—Ç–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥:

```objc
- (void)parserDidEndDocument:(NSXMLParser *)parser;
```

–î–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç —É –¥–µ–ª–µ–≥–∞—Ç–∞ –ø–∞—Ä—Å–µ—Ä–æ–º –∫–æ–≥–¥–∞ –ø–∞—Ä—Å–µ—Ä –≤—Å—Ç—Ä–µ—á–∞–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏–π—Å—è —Ç–µ–≥:

```objc
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName
  namespaceURI:(NSString *)namespaceURI
 qualifiedName:(NSString *)qName
    attributes:(NSDictionary<NSString *, NSString *> *)attributeDict;
```

–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —É –¥–µ–ª–µ–≥–∞—Ç–∞ –ø–∞—Ä—Å–µ—Ä–æ–º –∫–æ–≥–¥–∞ –ø–∞—Ä—Å–µ—Ä –≤—Å—Ç—Ä–µ—á–∞–µ—Ç –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–π—Å—è —Ç–µ–≥:

```objc
- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName
  namespaceURI:(nullable NSString *)namespaceURI
 qualifiedName:(nullable NSString *)qName;
```

.. –∏ –¥–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —É –¥–µ–ª–µ–≥–∞—Ç–∞ –ø–∞—Ä—Å–µ—Ä–æ–º –∫–æ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤–µ—Å—å –∏–ª–∏ —á–∞—Å—Ç—å –≤—Å—Ç—Ä–µ—á–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —É —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞:

```objc
- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string;
```


## Useful materials ü§ì

[Apple. NSURLSession](https://developer.apple.com/documentation/foundation/nsurlsession)

[Apple. Networking](https://developer.apple.com/documentation/network)

[Apple. Downloading Files in the Background](https://developer.apple.com/documentation/foundation/url_loading_system/downloading_files_in_the_background)

[Mozilla HTTP](https://developer.mozilla.org/en-US/docs/Web/HTTP)

[w3schools Introduction to XML](https://www.w3schools.com/xml/)

[w3schools JSON - Introduction](https://www.w3schools.com/js/js_json_intro.asp)

[Apple. NSXMLParser](https://developer.apple.com/documentation/foundation/nsxmlparser?language=objc)

[Apple. NSJSONSerialization](https://developer.apple.com/forums/thread/110414)

